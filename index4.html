<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Financial Planner Portal</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
  body { background: #f8f9fa; }
  .header { background: #004085; color: white; padding: 15px; text-align: center; border-radius: 5px; margin-bottom: 20px; }
  .card { box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-radius: 10px; }
  .btn-primary { background: #004085; border: none; }
  .btn-primary:hover { background: #002752; }
  .result-box { border: 1px solid #ddd; border-radius: 8px; padding: 10px; background: #fff; margin-bottom: 10px; }
  .label-left { font-weight: bold; margin-top: 5px; }
</style>
<script>
let chart;
function calculatePlan() {
  const clientName = document.getElementById('clientName').value || "Client";
  const today = new Date().toLocaleDateString();

  const currentAge = parseInt(document.getElementById('currentAge').value) || 0;
  const retirementAge = parseInt(document.getElementById('retirementAge').value) || 0;
  const lifeExpectancy = parseInt(document.getElementById('lifeExpectancy').value) || 0;
  const yearsToRetirement = Math.max(retirementAge - currentAge, 0);
  const retirementYears = Math.max(lifeExpectancy - retirementAge, 0);

  const inflationRate = 0.07;
  const investmentReturn = 0.12;
  const r = investmentReturn / 12;
  const n = yearsToRetirement * 12;

  function safeNumber(val) {
    return isNaN(val) || !isFinite(val) ? 0 : val;
  }

  function futureValueAnnual(goal, years) {
    return safeNumber(goal * ((Math.pow(1 + inflationRate, years) - 1) / inflationRate));
  }
  function futureValue(goal) {
    return safeNumber(goal * Math.pow(1 + inflationRate, yearsToRetirement));
  }

  const educationInput = parseFloat(document.getElementById('educationGoal').value) || 0;
  const educationGoalFV = futureValue(educationInput);

  const realEstateInput = parseFloat(document.getElementById('realEstateGoal').value) || 0;
  const realEstateGoalFV = futureValue(realEstateInput);

  const intlTripCost = parseFloat(document.getElementById('internationalTripCost').value) || 0;
  const intlTripsPerYear = parseInt(document.getElementById('internationalTripsPerYear').value) || 0;
  const intlTripFV = futureValueAnnual(intlTripCost * intlTripsPerYear, yearsToRetirement);

  const domTripCost = parseFloat(document.getElementById('domesticTripCost').value) || 0;
  const domTripsPerYear = parseInt(document.getElementById('domesticTripsPerYear').value) || 0;
  const domTripFV = futureValueAnnual(domTripCost * domTripsPerYear, yearsToRetirement);

  const healthInput = parseFloat(document.getElementById('healthGoal').value) || 0;
  const healthGoalFV = futureValue(healthInput);

  const retirementMonthly = parseFloat(document.getElementById('retirementGoalMonthly').value) || 0;
  const futureMonthlyRetirement = safeNumber(retirementMonthly * Math.pow(1 + inflationRate, yearsToRetirement));
  const retirementCorpusFV = safeNumber(futureMonthlyRetirement * 12 * retirementYears);

  function sip(goalFV) {
    if (n <= 0 || r <= 0) return 0;
    return safeNumber(goalFV * r / (Math.pow(1 + r, n) - 1));
  }

  const sipEducation = sip(educationGoalFV);
  const sipRealEstate = sip(realEstateGoalFV);
  const sipIntlTrip = sip(intlTripFV);
  const sipDomTrip = sip(domTripFV);
  const sipHealth = sip(healthGoalFV);
  const sipRetirement = sip(retirementCorpusFV);
  const sipTotal = sipEducation + sipRealEstate + sipIntlTrip + sipDomTrip + sipHealth + sipRetirement;

  const annualExpenses = ((parseFloat(document.getElementById('rentExpense').value) || 0) + (parseFloat(document.getElementById('groceriesExpense').value) || 0) + (parseFloat(document.getElementById('utilitiesExpense').value) || 0) + (parseFloat(document.getElementById('staffSalaryExpense').value) || 0) + (parseFloat(document.getElementById('homeLoanEMI').value) || 0) + (parseFloat(document.getElementById('personalLoanEMI').value) || 0) + (parseFloat(document.getElementById('educationLoanEMI').value) || 0) + (parseFloat(document.getElementById('entertainmentExpense').value) || 0) + (parseFloat(document.getElementById('fashionExpense').value) || 0)) * 12;
  const recommendedLifeCover = safeNumber(annualExpenses * 10);

  document.getElementById('result').innerHTML = `
    <h5>Financial Plan for ${clientName}</h5>
    <p><strong>Date:</strong> ${today}</p>
    <div class="result-box">Education Goal: ₹${educationInput} → FV: ₹${educationGoalFV.toFixed(2)} → SIP: ₹${sipEducation.toFixed(2)}</div>
    <div class="result-box">Real Estate/Other Goal: ₹${realEstateInput} → FV: ₹${realEstateGoalFV.toFixed(2)} → SIP: ₹${sipRealEstate.toFixed(2)}</div>
    <div class="result-box">International Travel: ₹${intlTripCost} × ${intlTripsPerYear}/yr → FV: ₹${intlTripFV.toFixed(2)} → SIP: ₹${sipIntlTrip.toFixed(2)}</div>
    <div class="result-box">Domestic Travel: ₹${domTripCost} × ${domTripsPerYear}/yr → FV: ₹${domTripFV.toFixed(2)} → SIP: ₹${sipDomTrip.toFixed(2)}</div>
    <div class="result-box">Health Goal (Monthly): ₹${healthInput} → FV: ₹${healthGoalFV.toFixed(2)} → SIP: ₹${sipHealth.toFixed(2)}</div>
    <div class="result-box">Retirement: ₹${retirementMonthly}/mo → FV Monthly: ₹${futureMonthlyRetirement.toFixed(2)} → Corpus: ₹${retirementCorpusFV.toFixed(2)} → SIP: ₹${sipRetirement.toFixed(2)}</div>
    <hr>
    <div class="result-box"><strong>Total SIP Required:</strong> ₹${sipTotal.toFixed(2)}</div>
    <div class="result-box"><strong>Recommended Life Insurance Cover:</strong> ₹${recommendedLifeCover.toFixed(2)}</div>
    <canvas id="sipChart" height="200"></canvas>
    <button class="btn btn-secondary mt-3" onclick="downloadPDF('${clientName}', '${today}')">Download PDF</button>
  `;

  const ctx = document.getElementById('sipChart');
  if (chart) chart.destroy();
  chart = new Chart(ctx, {
    type: 'pie',
    data: {
      labels: ['Education', 'Real Estate/Other', 'International Travel', 'Domestic Travel', 'Health', 'Retirement'],
      datasets: [{
        data: [sipEducation, sipRealEstate, sipIntlTrip, sipDomTrip, sipHealth, sipRetirement],
        backgroundColor: ['#007bff','#28a745','#ffc107','#17a2b8','#fd7e14','#6f42c1']
      }]
    }
  });
}
</script>
</head>
<body>
<div class="container my-5">
  <div class="header">
    <h2>Financial Planning Portal</h2>
    <p>Plan your investments and insurance smartly</p>
  </div>
  <div class="card p-4 mb-4">
    <h5 class="mb-3">Client Details</h5>
    <label class="label-left">Client Name</label>
    <input type="text" id="clientName" class="form-control mb-2">
    <label class="label-left">Current Age</label>
    <input type="number" id="currentAge" class="form-control mb-2">
    <label class="label-left">Retirement Age</label>
    <input type="number" id="retirementAge" class="form-control mb-2">
    <label class="label-left">Life Expectancy</label>
    <input type="number" id="lifeExpectancy" class="form-control mb-2">
    <hr>
    <h6>Income (Monthly)</h6>
    <label class="label-left">Salary Income</label>
    <input type="number" id="salaryIncome" class="form-control mb-2">
    <label class="label-left">Other Income</label>
    <input type="number" id="otherIncome" class="form-control mb-2">
    <hr>
    <h6>Expenses (Monthly)</h6>
    <label class="label-left">Rent</label>
    <input type="number" id="rentExpense" class="form-control mb-2">
    <label class="label-left">Groceries</label>
    <input type="number" id="groceriesExpense" class="form-control mb-2">
    <label class="label-left">Utilities</label>
    <input type="number" id="utilitiesExpense" class="form-control mb-2">
    <label class="label-left">Staff Salaries</label>
    <input type="number" id="staffSalaryExpense" class="form-control mb-2">
    <label class="label-left">Home Loan EMI</label>
    <input type="number" id="homeLoanEMI" class="form-control mb-2">
    <label class="label-left">Personal Loan EMI</label>
    <input type="number" id="personalLoanEMI" class="form-control mb-2">
    <label class="label-left">Education Loan EMI</label>
    <input type="number" id="educationLoanEMI" class="form-control mb-2">
    <label class="label-left">Entertainment</label>
    <input type="number" id="entertainmentExpense" class="form-control mb-2">
    <label class="label-left">Fashion</label>
    <input type="number" id="fashionExpense" class="form-control mb-2">
    <hr>
    <h6>Goals</h6>
    <label class="label-left">Education Goal (₹)</label>
    <input type="number" id="educationGoal" class="form-control mb-2">
    <label class="label-left">International Trip Cost</label>
    <input type="number" id="internationalTripCost" class="form-control mb-2">
    <label class="label-left">International Trips per Year</label>
    <input type="number" id="internationalTripsPerYear" class="form-control mb-2">
    <label class="label-left">Domestic Trip Cost</label>
    <input type="number" id="domesticTripCost" class="form-control mb-2">
    <label class="label-left">Domestic Trips per Year</label>
    <input type="number" id="domesticTripsPerYear" class="form-control mb-2">
    <label class="label-left">Health Goal (Monthly)</label>
    <input type="number" id="healthGoal" class="form-control mb-2">
    <label class="label-left">Real Estate/Other Goal</label>
    <input type="number" id="realEstateGoal" class="form-control mb-2">
    <label class="label-left">Retirement Goal (Monthly)</label>
    <input type="number" id="retirementGoalMonthly" class="form-control mb-2">
    <hr>
    <h6>Current Investments (Monthly Contributions)</h6>
    <label class="label-left">Gold Investments</label>
    <input type="number" id="currentGoldInvest" class="form-control mb-2">
    <label class="label-left">Real Estate/Other Investments</label>
    <input type="number" id="currentRealEstateInvest" class="form-control mb-2">
    <label class="label-left">Mutual Fund Investments</label>
    <input type="number" id="currentMutualFundInvest" class="form-control mb-2">
    <hr>
    <h6>Insurance</h6>
    <label class="label-left">Annual Health Insurance Premium</label>
    <input type="number" id="healthPremium" class="form-control mb-2">
    <label class="label-left">Annual Life Insurance Premium</label>
    <input type="number" id="lifePremium" class="form-control mb-2">
    <label class="label-left">Parents' Annual Health Insurance Premium</label>
    <input type="number" id="parentsHealthPremium" class="form-control mb-2">
    <label class="label-left">Total Health Insurance Coverage</label>
    <input type="number" id="healthCoverage" class="form-control mb-2">
    <label class="label-left">Parents' Health Insurance Coverage</label>
    <input type="number" id="parentsHealthCoverage" class="form-control mb-2">
    <label class="label-left">Total Life Insurance Coverage</label>
    <input type="number" id="lifeCoverage" class="form-control mb-2">
    <button class="btn btn-primary mt-4" onclick="calculatePlan()">Calculate Plan</button>
  </div>
  <div id="result" class="card p-4 mt-4"></div>
</div>
</body>
</html>
